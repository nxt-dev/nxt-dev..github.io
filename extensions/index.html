<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Extensions - NXT User Docs</title>
        <link href="../css/bootstrap.css" rel="stylesheet">
        <link href="../css/font-awesome.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">NXT User Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../concepts/" class="nav-link">Concepts</a>
                            </li>
                            <li class="navitem">
                                <a href="../tutorials/" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../install/" class="nav-link">Installation</a>
                            </li>
                            <li class="navitem">
                                <a href="../reference/" class="nav-link">Reference</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Extensions</a>
                            </li>
                            <li class="navitem">
                                <a href="../api/" class="nav-link">API</a>
                            </li>
                            <li class="navitem">
                                <a href="../license/" class="nav-link">License</a>
                            </li>
                            <li class="navitem">
                                <a href="../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../reference/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../api/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#extensions" class="nav-link">Extensions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#simple-remote-context" class="nav-link">Simple Remote Context</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#in-depth-explanations" class="nav-link">In depth explanations:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#plugins" class="nav-link">Plugins</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="extensions">Extensions</h1>
<p>NXT can easily extended to better meet a user's/studio's needs. In this section you will find examples of how to use NXT's configuration and plugin system.</p>
<p><strong>If you're looking for a quick test and not trying to dive too deep, we have an <em>almost</em> drag and drop example Maya context <a href="https://github.com/nxt-dev/nxt_editor/tree/release/examples/quick_start_graphs">here</a>.</strong> </p>
<h2 id="simple-remote-context">Simple Remote Context</h2>
<p>In Maya simply navigate to the nxt menu and select "Create Maya Context". You'll be prompted to enter a name, the name you enter will be how you call your custom Maya context.
For more on using custom contexts <a href="../tutorials/#contexts">see here</a>.</p>
<h1 id="in-depth-explanations">In depth explanations:</h1>
<h3 id="config-dir">Config dir</h3>
<p>Custom configurations are graphs and code that extends or alters the functionality of nxt. Cofigs are not to be confused with preferences which are solely UX related.</p>
<p>To add a config there are two approaches, both of which are compatible with eachother.</p>
<ol>
<li>
<p>Local config</p>
</li>
<li>
<p>Config directory location: <code>~/nxt/config/&lt;major_api_version&gt;</code></p>
</li>
</ol>
<p>2- Site config</p>
<ul>
<li>Site config directory can be set via an environment variable. <code>NXT_SITE_DIR=/path/to/site_config</code></li>
</ul>
<p>Inside the config dir you'll need a directory called <code>plugins</code>. So for example if you're using API <code>v0.1.2</code> your local config plugins dir would be: <code>~/nxt/config/0/plugins</code></p>
<h1 id="plugins">Plugins</h1>
<p>Any <code>.py</code> files inside your plugin dir(s) will automatically be imported during nxt startup. </p>
<h3 id="creating-custom-contexts-automatically">Creating Custom Contexts (Automatically)</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need to create your own <code>context_graph</code> <a href="#maya_2020_contextnxt">see below</a> for how to do that.</p>
</div>
<pre><code class="language-python">import nxt
nxt.create_context('MyContext', 
                   interpreter_exe='/path/to/python/executable/SpecialPython.exe', 
                   context_graph='SpecialPython_context.nxt')
</code></pre>
<h3 id="creating-custom-contexts-manually">Creating Custom Contexts (Manually)</h3>
<p>It is possible to execute graphs in "remote contexts," for example it one may want to execute a graph in a headless Maya session. These remote contexts can easilly be configured by users and TDs, this section will provide some examples on how to go about writing your own custom context plugin.</p>
<p>Below is an exmaple of creating a custom Maya context. This code is an example to get you started, its not the <em>only</em> way to do things.</p>
<p>Files we'll be creating:</p>
<pre><code>Plugins
   |_ my_custom_contexts.py
   |_ maya_2020_context.nxt
</code></pre>
<h4 id="my_custom_contextspy">my_custom_contexts.py</h4>
<p>The following example is for Maya 2020 running on Windows.</p>
<p>The two imports from nxt that you'll need are the <code>RemoteContext</code> class and <code>register_context</code> function. The first arg in <code>RemoteContexts</code> is the <strong>context name</strong>, this will be used by users to call your context. Next we have the context executable, this must be a python (currently only <code>Python 2.7</code>) executable. And finally the path to your context graph.</p>
<pre><code class="language-python"># Builtin
import os
# External
from nxt.remote.contexts import RemoteContext, register_context
# Maya 2020
maya2020_name = 'maya2020'
maya2020_exe = 'C:/Program Files/Autodesk/Maya2020/bin/mayapy.exe'
maya2020_graph = os.path.abspath(os.path.join(os.path.dirname(__file__),
                                              'maya_2020_context.nxt'))
maya_2020_context = RemoteContext(maya2020_name, maya2020_exe, maya2020_graph)
register_context(maya_2020_context)
</code></pre>
<h4 id="maya_2020_contextnxt">maya_2020_context.nxt</h4>
<p>Now to write your context graph.</p>
<p>1) Create an nxt graph and make sure to add the following reference layer:</p>
<pre><code class="language-json">&quot;references&quot;: [
    &quot;$NXT_BUILTINS/_context.nxt&quot;
]
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To add a layer like this (using the env var) right click on your layer in the layer manager and select <code>Reference Builtin Graph</code></p>
</div>
<p>2) On the <code>/</code> node add an attr called <code>maya_inst_name</code> and set its value to <code>nxt</code></p>
<p>3) Also on the <code>/</code> node we're going to want to write some custom code in. Add
 the following to the code block.</p>
<pre><code class="language-python">cwd = os.path.dirname(sys.executable)
python_home = os.path.abspath(os.path.join(cwd, '..', 'Python/Lib/site-packages'))
sys.path.insert(0, python_home)
from maya import standalone
</code></pre>
<p><em>This will add the Maya site-packages to your environment and import
 <code>maya.standalone</code>.</em></p>
<p>4) In the <code>/enter/init</code> node you'll want to add your own custom code, something like this:</p>
<pre><code class="language-python">STAGE.old_cwd = os.getcwd()
maya_cwd = os.path.dirname(sys.executable) 
os.chdir(maya_cwd) 
standalone.initialize(name='${maya_inst_name}')
</code></pre>
<p>5) In the <code>/enter/teardown</code> node you want to uninitialize Maya, add the following code:</p>
<pre><code class="language-python">standalone.uninitialize(name='${maya_inst_name}')
os.chdir(STAGE.old_cwd)
</code></pre>
<h3 id="using-custom-contexts">Using Custom Contexts</h3>
<h4 id="from-inside-a-graph">From inside a graph</h4>
<ol>
<li>
<p>Make sure your graph has this reference layer: <code>$NXT_BUILTINS/remote_contexts.nxt</code></p>
</li>
<li>
<p>Create a node, lets call it <code>run_in_maya"</code></p>
</li>
<li>
<p>Set your new node's instance path to <code>/_remote_sub_graph</code></p>
</li>
<li>
<p>Set the <code>_context</code> attr to the raw <strong>context name</strong> you have access to or just created.</p>
</li>
<li>
<p>Set the <code>_graph_path</code> attr to the path to a graph that you wish to run in the remote context.</p>
</li>
</ol>
<p>Note: Any other attributes on or inherited by your node <code>/run_in_maya</code> will be inherited by the <code>/</code> node of your remote graph.</p>
<h4 id="from-apicli">From api/cli</h4>
<pre><code class="language-batch">nxt exe /path/to/graph.nxt --context maya2020
</code></pre>
<p>or</p>
<pre><code class="language-python">import nxt
nxt.execute_graph('/path/to/graph.nxt' context='maya2020')
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>2021 NXT Authors</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
